## Metadata Service 

Metadata Service of EC2 Instanz
```
curl http://169.254.169.254/latest/meta-data
```

Metadata Service URL for Security Credentials
```
http://169.254.169.254/latest/meta-data/iam/security-credentials/
```

Anfrage von IAM Credentials
```
http://169.254.169.254/latest/meta-data/iam/security-credentials/*role_name*/
```

Zugriff auf EC2 User-Daten
```
curl http://169.254.169.254/latest/user-data
```

### IMDSv2

In Version 2 the user has to create and use a token to access the metadata service. This technique adds a layer of protection against SSRF attacks.

```
TOKEN=`curl -X PUT "http://169.254.169.254/latest/api/token" -H "X-aws-ec2-metadata-token-ttl-seconds: 21600"`
```

```
curl -H "X-aws-ec2-metadata-token: $TOKEN" -v http://169.254.169.254/latest/meta-data/
```


Abfrage nach verf√ºgbaren EBS Snapshots
```
aws ec2 describe-snapshots --restorable-by-user-ids all --owner-ids 000000000000
```

Abfrage nach Subnets
```
aws ec2 describe-subnets
```

Abfrage von Sicherheitsgruppen (Security Groups)
```
aws ec2 describe-security-groups
```

Automatisierter Ansatz mit Prowler
```
./prowler -c ec2_ebs_public_snapshot
```















